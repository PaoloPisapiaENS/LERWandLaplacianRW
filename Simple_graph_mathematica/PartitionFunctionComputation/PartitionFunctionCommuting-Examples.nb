(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    173128,       4820]
NotebookOptionsPosition[    161538,       4607]
NotebookOutlinePosition[    162031,       4626]
CellTagsIndexPosition[    161988,       4623]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
We want to implement a partition function computing algorithm. LET\
\[CloseCurlyQuote]S TRY WITH THE STANDARD PRODUCT (i.e. commutation)\
\>", "Item",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.939118617351705*^9, 3.939118617351705*^9}, {
  3.939119745052809*^9, 3.9391197498140736`*^9}, {3.9397053973768826`*^9, 
  3.9397053973787994`*^9}},ExpressionUUID->"79ff84b5-8f52-354a-8abb-\
0141ba4fffee"],

Cell["\<\
Throughout the code we use the Zeta function to replace positive parameters \
to avoid that Mathematica does weird stuff\
\>", "Subsubitem",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.939118617351705*^9, 3.939118617351705*^9}, {
  3.939119745052809*^9, 3.9391197498140736`*^9}, {3.9397053999409885`*^9, 
  3.9397054657660007`*^9}},ExpressionUUID->"539045f2-e12e-f740-a199-\
c241b5b317fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["After many trials, we arrived at the following conclusions:", "Item",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.9391186186631966`*^9, 
  3.939118636904541*^9}},ExpressionUUID->"31116618-da27-1d4a-85a6-\
754212ab01f6"],

Cell[TextData[{
 "1) In order to get the \[OpenCurlyDoubleQuote]loop structure\
\[CloseCurlyDoubleQuote], we simply need the terms with the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", "..."], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f60a96b9-7a27-f24f-a197-56bef9a57da0"],
 ". "
}], "Subitem",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.9391186186631966`*^9, 
  3.939118683381716*^9}},ExpressionUUID->"fedbeb3d-3112-1f4b-9df1-\
67ec93f26a6a"],

Cell["\<\
2) We do not need to explicate all the flavour indices: we just need to use \
different indices for each term, then use the Kronecker \[Delta] and then sum \
over them with the classical rules. When one obtains \[Delta][a,a] then it\
\[CloseCurlyQuote]s equal to n. This number represents the number of fermions \
minus the number of bosons, and it is the \[OpenCurlyDoubleQuote]weight\
\[CloseCurlyDoubleQuote] of each loop. Kay says that we should substitute it \
with n->-2, but it seems that n->-1 is the one that works.\
\>", "Subitem",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.9391186186631966`*^9, 
  3.939118880938663*^9}},ExpressionUUID->"07b41a31-a66d-b94f-8038-\
5ec3cb977be5"],

Cell[CellGroupData[{

Cell["\<\
3) There is no need for any fancy commutation relation, berezinIntegral or \
wickContraction: simply use the nihilpotency of the fields to get rid of the \
\[OpenCurlyDoubleQuote]wrong\[CloseCurlyDoubleQuote] terms, then substitute:\
\>", "Subitem",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.9391186186631966`*^9, 3.9391189617676163`*^9}, {
  3.939119000787983*^9, 
  3.939119001358324*^9}},ExpressionUUID->"2aa48082-2775-ef43-b8df-\
87e820637338"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "nihilpotency", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nihilpotency", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"A_", "[", 
      RowBox[{"x_", ",", "i_"}], "]"}], "*", 
     RowBox[{"A_", "[", 
      RowBox[{"x_", ",", "i_"}], "]"}]}], "\[Rule]", "0"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.938831202037205*^9, 3.938831218346205*^9}, {
  3.938835183007219*^9, 3.938835184620882*^9}, {3.938835289850413*^9, 
  3.9388352905285378`*^9}, {3.9388384317914333`*^9, 3.938838439336839*^9}, {
  3.9388453483033237`*^9, 3.938845365108453*^9}, {3.938846216950609*^9, 
  3.938846244127346*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"26d07459-8f8c-0b4c-98da-5920d2d2e881"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "contraction", "]"}], "\[IndentingNewLine]", 
 RowBox[{"contraction", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "a_"}], "]"}], "*", 
      RowBox[{"\[Phi]s", "[", 
       RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
      "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "a_"}], "]"}], "*", 
      RowBox[{"\[Phi]s", "[", 
       RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939119028738727*^9, 3.9391190640011864`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"0b794d01-a48c-684b-bfab-b10bb6379e2f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], " ", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"x_", ",", "b_"}], "]"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"D\[Delta]", "[", "x", "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"a", ",", "b", ",", "x"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], " ", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9391197936034985`*^9, 3.9397056971640625`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"ccc6380b-8315-9f48-9d19-c7124ade7500"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4) Finally, simplify the \[Delta]\[CloseCurlyQuote]s and substitute \
everything", "Subitem",
 CellChangeTimes->{{3.939119034764269*^9, 3.939119036436605*^9}, {
  3.9391191024194355`*^9, 
  3.9391191451458263`*^9}},ExpressionUUID->"b171f651-1cd1-c14b-a825-\
4622ed538a0f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalSigma]\[Delta]rule", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]\[Delta]rule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"b_", ",", "a_"}], "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"c_", ",", "b_"}], "]"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"c", ",", "a"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"b_", ",", "c_"}], "]"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "c"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "a", "]"}]}], ")"}]}], ":>", "n"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9391131881501617`*^9, 3.939113283186725*^9}, {
  3.939113389840746*^9, 3.939113402757696*^9}, {3.939113449313545*^9, 
  3.939113458780845*^9}, {3.939113616347803*^9, 3.939113621073095*^9}, {
  3.939114336776186*^9, 3.939114336837799*^9}, {3.939114949323351*^9, 
  3.939114951038183*^9}, {3.939114988558977*^9, 3.939114988909434*^9}, {
  3.939115028918001*^9, 3.93911504717482*^9}, {3.939115105664192*^9, 
  3.939115141306975*^9}, {3.939115232438454*^9, 3.939115233263678*^9}, {
  3.939122214889879*^9, 3.939122250735031*^9}, {3.939179739198454*^9, 
  3.939179743863943*^9}, {3.9398752311200104`*^9, 3.9398752503305664`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f230b126-0c88-5d45-b8b1-6872d54b7e27"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalSigma]\[Delta]ruleMod", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]\[Delta]ruleMod", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"b_", ",", "a_", ",", "x_"}], "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"c_", ",", "b_", ",", "y_"}], "]"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"c", ",", "a", ",", "y"}], "]"}], 
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"y", ",", "x"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_", ",", "x_"}], "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"b_", ",", "c_", ",", "y_"}], "]"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "c", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a_", ",", "a_", ",", "x_"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "a", "]"}]}], ")"}]}], ":>", "n"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9391131881501617`*^9, 3.939113283186725*^9}, {
  3.939113389840746*^9, 3.939113402757696*^9}, {3.939113449313545*^9, 
  3.939113458780845*^9}, {3.939113616347803*^9, 3.939113621073095*^9}, {
  3.939114336776186*^9, 3.939114336837799*^9}, {3.939114949323351*^9, 
  3.939114951038183*^9}, {3.939114988558977*^9, 3.939114988909434*^9}, {
  3.939115028918001*^9, 3.93911504717482*^9}, {3.939115105664192*^9, 
  3.939115141306975*^9}, {3.939115232438454*^9, 3.939115233263678*^9}, {
  3.939122214889879*^9, 3.939122250735031*^9}, {3.939179739198454*^9, 
  3.939179743863943*^9}, {3.939893370701828*^9, 3.9398933716011868`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"8f0c5aa7-f172-2244-95d1-2a233962f71a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalSigma]D\[Delta]ruleMod", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]D\[Delta]ruleMod", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D\[Delta]", "[", "a_", "]"}], 
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "b_", "]"}]}], "->", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"a", ",", "b"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "b", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "b_", "]"}], 
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"a", ",", "b"}], "]"}], 
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"b", ",", "c"}], "]"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.939113324370577*^9, 3.939113327528763*^9}, {
   3.93911364045294*^9, 3.93911366377297*^9}, {3.939113725836361*^9, 
   3.939113726517611*^9}, {3.939113804615553*^9, 3.939113807647869*^9}, 
   3.93911384980804*^9, 3.939114044091543*^9, {3.9391145298378677`*^9, 
   3.939114533230047*^9}, {3.939114617245337*^9, 3.939114668684122*^9}, 
   3.939115384228779*^9, 3.9391154494889507`*^9, {3.9391155056920605`*^9, 
   3.9391155185301228`*^9}, {3.9391155806848583`*^9, 3.939115583388817*^9}, {
   3.93911567001511*^9, 3.9391157025436306`*^9}, {3.939115930651041*^9, 
   3.9391159459624786`*^9}, {3.939116016302918*^9, 3.9391160167004414`*^9}, {
   3.9391162294789505`*^9, 3.939116256555729*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"66b2709d-c021-1a4c-9429-5dbd0a0561ac"],

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"n", "->", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{
     RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.939119245757071*^9, 3.93911927789295*^9}, {
  3.939120193286455*^9, 3.939120196349069*^9}, {3.939179825116091*^9, 
  3.939179826020595*^9}},ExpressionUUID->"be0fdbc9-33b4-6a40-aaca-\
9b38b7bda553"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
4.bis) If there are external fields (e.g. in correlators) then we do not want \
to sum over their indices. Instead we want to keep only the terms which yield \
a non-vanishing \
\>", "Subitem",
 CellChangeTimes->{{3.939179827514393*^9, 
  3.939179920843826*^9}},ExpressionUUID->"c0e96f75-58d7-5146-b483-\
878f45e80c15"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[Delta]ruleExternalMod", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]ruleExternalMod", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a_", ",", "a_", ",", "x_"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"NumericQ", "[", "a", "]"}], ")"}]}], ":>", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_", ",", "x_"}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"NumericQ", "[", "a", "]"}], ")"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"a", "==", "b"}]}], ")"}]}], ":>", "0"}]}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.939179947628132*^9, 3.939180011782891*^9}, {
  3.939879903456558*^9, 3.939879906649355*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"261adeb5-dab9-2249-94b2-d22287175407"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[Delta]ruleExternal", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]ruleExternal", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"NumericQ", "[", "a", "]"}], ")"}]}], ":>", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"NumericQ", "[", "a", "]"}], ")"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"a", "==", "b"}]}], ")"}]}], ":>", "0"}]}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.939179947628132*^9, 3.939180011782891*^9}, {
  3.939879910309513*^9, 3.9398799137113533`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"5bae1f8b-782e-2145-b382-a133483fd60b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["E.g.1) Easiest case of all: simply 2 vertices: CORRECT!", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.939119918481055*^9}, {
  3.9391202242272396`*^9, 
  3.939120228496233*^9}},ExpressionUUID->"9ae37851-07b4-ee45-b599-\
6a9f52e2c880"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "x"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"y", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"x", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "y"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "7", "]"}], "/", 
          RowBox[{"Zeta", "[", "9", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"x", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"y", ",", "j"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Zeta", "[", "5", "]"}], "->", 
       SubscriptBox["\[Beta]", "xy"]}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], "->", 
       SubscriptBox["r", "x"]}], ",", "  ", 
      RowBox[{
       RowBox[{"Zeta", "[", "7", "]"}], "->", 
       SubscriptBox["\[Beta]", "yx"]}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "9", "]"}], "->", 
       SubscriptBox["r", "y"]}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "->", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939120033231417*^9, 3.93912009671538*^9}, {
  3.939120143674591*^9, 3.9391202074098396`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"c20a91b7-8a7e-ac48-981e-7ce77c901821"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"D\[Delta]", "[", "x", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"y", ",", "x"}], "]"}], " ", 
    RowBox[{"Zeta", "[", "5", "]"}], " ", 
    RowBox[{"Zeta", "[", "7", "]"}]}], 
   RowBox[{
    RowBox[{"Zeta", "[", "3", "]"}], " ", 
    RowBox[{"Zeta", "[", "9", "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.9391222591515617`*^9, 
   3.9397251427635536`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"d6665997-4f93-f449-a680-f01fc35a4d59"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"D\[Delta]", "[", "x", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"y", ",", "x"}], "]"}], " ", 
    SubscriptBox["\[Beta]", "xy"], " ", 
    SubscriptBox["\[Beta]", "yx"]}], 
   RowBox[{
    SubscriptBox["r", "x"], " ", 
    SubscriptBox["r", "y"]}]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.9391222591515617`*^9, 
   3.939725142767151*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"10d6bf0a-0b6a-cf49-8cd8-63a076d64f4c"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["\[Beta]", "xy"], " ", 
    SubscriptBox["\[Beta]", "yx"]}], 
   RowBox[{
    SubscriptBox["r", "x"], " ", 
    SubscriptBox["r", "y"]}]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.9391222591515617`*^9, 
   3.9397251427700844`*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"6c3c7b79-3734-b64f-a963-619774f85b6b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E.g.2.1) Slightly more complicated: 3 vertices a,b,c. Starts from a and can \
go directly to c or passing through b. At b there can be a self-loop. Total \
absorption at c. CORRECT!!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.939119918481055*^9}, {
   3.9391202242272396`*^9, 3.93912026800753*^9}, {3.939120316132612*^9, 
   3.939120370520834*^9}, {3.939120416186205*^9, 3.939120423254008*^9}, {
   3.93912076689037*^9, 3.939120790737067*^9}, {3.939811020259966*^9, 
   3.939811020467525*^9}, {3.9398110621980553`*^9, 3.939811080516915*^9}, 
   3.939875272542576*^9},ExpressionUUID->"ae10d59d-ec9c-0a44-bf94-\
a5d9839ac1c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "a"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"c", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"a", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "7", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"b", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"a", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "b"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "9", "]"}], "/", 
          RowBox[{"Zeta", "[", "11", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"c", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"b", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "15", "]"}], "/", 
          RowBox[{"Zeta", "[", "11", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"b", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"b", ",", "j"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Zeta", "[", "5", "]"}], "->", 
       RowBox[{"\[Beta]", "''"}]}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], "->", 
       SubscriptBox["r", "a"]}], ",", "  ", 
      RowBox[{
       RowBox[{"Zeta", "[", "7", "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "9", "]"}], "->", 
       RowBox[{"\[Beta]", "'''"}]}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "13", "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "11", "]"}], "->", 
       SubscriptBox["r", "b"]}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "15", "]"}], "->", 
       RowBox[{"\[Beta]", "'"}]}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox[
     SuperscriptBox["Z", "d"], "abc"], "=", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939120033231417*^9, 3.93912009671538*^9}, {
  3.939120143674591*^9, 3.9391202074098396`*^9}, {3.939120375509392*^9, 
  3.9391204070097237`*^9}, {3.939120437494154*^9, 3.939120614655537*^9}, {
  3.939122027308365*^9, 3.939122030869249*^9}, {3.9398110875335445`*^9, 
  3.9398111545219975`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"d022a4c7-ba46-ca4f-93a4-78118a84b278"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"D\[Delta]", "[", "b", "]"}], " ", 
    RowBox[{"Zeta", "[", "15", "]"}]}], 
   RowBox[{"Zeta", "[", "11", "]"}]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, 3.939122031355747*^9, 3.939122269444992*^9, 
   3.939180044381092*^9, 3.939810688202257*^9, 3.9398110883265495`*^9, {
   3.939811127133217*^9, 3.939811155455065*^9}},
 CellLabel->
  "Out[144]=",ExpressionUUID->"08684113-6367-2e4a-90a9-06ddc8385245"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"D\[Delta]", "[", "b", "]"}], " ", 
    SuperscriptBox["\[Beta]", "\[Prime]",
     MultilineFunction->None]}], 
   SubscriptBox["r", "b"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, 3.939122031355747*^9, 3.939122269444992*^9, 
   3.939180044381092*^9, 3.939810688202257*^9, 3.9398110883265495`*^9, {
   3.939811127133217*^9, 3.939811155458023*^9}},
 CellLabel->
  "Out[145]=",ExpressionUUID->"c26e235b-3941-3645-b942-5178f0e54d58"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   SuperscriptBox["\[Beta]", "\[Prime]",
    MultilineFunction->None], 
   SubscriptBox["r", "b"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, 3.939122031355747*^9, 3.939122269444992*^9, 
   3.939180044381092*^9, 3.939810688202257*^9, 3.9398110883265495`*^9, {
   3.939811127133217*^9, 3.9398111554609966`*^9}},
 CellLabel->
  "Out[146]=",ExpressionUUID->"1dba768f-4fb3-9444-b05b-453245e469fa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E.g.2.2) Slightly more complicated: 3 vertices a,b,c. Starts from a and can \
go directly to c or passing through b. At b there can be a self-loop and it \
could also come back to a. Total absorption at c. CORRECT!!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.939119918481055*^9}, {
  3.9391202242272396`*^9, 3.93912026800753*^9}, {3.939120316132612*^9, 
  3.939120370520834*^9}, {3.939120416186205*^9, 3.9391204232540083`*^9}, {
  3.93912076689037*^9, 3.9391207907370667`*^9}, {3.939811020259966*^9, 
  3.9398110204675255`*^9}, {3.939811059087229*^9, 
  3.939811059311037*^9}},ExpressionUUID->"5b9fd806-f94c-5a44-954b-\
ab372ccb3a73"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "a"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"c", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"a", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "7", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"b", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"a", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "b"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "9", "]"}], "/", 
          RowBox[{"Zeta", "[", "11", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"c", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"b", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "13", "]"}], "/", 
          RowBox[{"Zeta", "[", "11", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"a", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"b", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "15", "]"}], "/", 
          RowBox[{"Zeta", "[", "11", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"b", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"b", ",", "j"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]rule"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "->", 
        RowBox[{"\[Beta]", "''"}]}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "3", "]"}], "->", 
        SubscriptBox["r", "a"]}], ",", "  ", 
       RowBox[{
        RowBox[{"Zeta", "[", "7", "]"}], "->", "\[Beta]"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "9", "]"}], "->", 
        RowBox[{"\[Beta]", "'''"}]}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "13", "]"}], "->", "\[Beta]"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "11", "]"}], "->", 
        SubscriptBox["r", "b"]}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "15", "]"}], "->", 
        RowBox[{"\[Beta]", "'"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox[
     SuperscriptBox["Z", "u"], "abc"], "=", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{"n", "->", 
       RowBox[{"-", "1"}]}], "}"}]}]}]}]}]], "Input",
 PageWidth->PaperWidth,
 CellChangeTimes->{{3.939120033231417*^9, 3.93912009671538*^9}, {
   3.939120143674591*^9, 3.9391202074098396`*^9}, {3.939120375509392*^9, 
   3.9391204070097237`*^9}, {3.939120437494154*^9, 3.939120614655537*^9}, {
   3.939122027308365*^9, 3.939122030869249*^9}, {3.939811161761045*^9, 
   3.939811172215084*^9}, {3.939875279854307*^9, 3.939875294252804*^9}, 
   3.939876008854748*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"30fde334-9436-4d41-a62c-741e1f70b2c9"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   SuperscriptBox["\[Beta]", "2"], 
   RowBox[{
    SubscriptBox["r", "a"], " ", 
    SubscriptBox["r", "b"]}]], "-", 
  FractionBox[
   SuperscriptBox["\[Beta]", "\[Prime]",
    MultilineFunction->None], 
   SubscriptBox["r", "b"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, 3.939122031355747*^9, 3.939122269444992*^9, 
   3.939180044381092*^9, 3.939810688202257*^9, {3.939811163186458*^9, 
   3.939811172563963*^9}, 3.939875306290943*^9, 3.9398761761983395`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"61b93443-8fac-1c44-868b-57557d5e7955"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]s", "->", "1"}], ",", " ", 
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"\[Beta]p", "->", "1"}], ",", 
    RowBox[{
     SubscriptBox["r", "b"], "->", "4"}], ",", 
    RowBox[{
     SubscriptBox["r", "a"], "->", "3"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9391206539414234`*^9, 3.939120758139254*^9}},
 CellLabel->
  "In[2157]:=",ExpressionUUID->"89dcc36f-f472-bd44-9dc5-1cf21f4541e3"],

Cell[BoxData[
 FractionBox["2", "3"]], "Output",
 CellChangeTimes->{{3.939120740966526*^9, 3.939120758678023*^9}},
 CellLabel->
  "Out[2157]=",ExpressionUUID->"4d1384b6-8f2a-8941-897f-b1c112fff1dc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E.g.3.0) 2x2 square lattice: everything has the same weight and every vertex \
is connected both forward and backward. CORRECT!!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.939119918481055*^9}, {
   3.9391202242272396`*^9, 3.93912026800753*^9}, {3.939120316132612*^9, 
   3.939120370520834*^9}, {3.939120416186205*^9, 3.9391204232540083`*^9}, {
   3.93912076689037*^9, 3.9391207907370667`*^9}, {3.939120865256918*^9, 
   3.939120924967476*^9}, 3.9391209911409397`*^9, {3.93989334406592*^9, 
   3.939893345373722*^9}},ExpressionUUID->"95f6d0ff-e871-a248-8411-\
f5b605eff070"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "1"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "l"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "l"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "l"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "l"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "->", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9391200332314167`*^9, 3.9391200967153797`*^9}, {
  3.939120143674591*^9, 3.9391202074098396`*^9}, {3.939120375509392*^9, 
  3.9391204070097237`*^9}, {3.939120437494154*^9, 3.9391206146555367`*^9}, {
  3.9391209294803505`*^9, 3.939120961324808*^9}, {3.9391210030295715`*^9, 
  3.939121033656*^9}},
 CellLabel->
  "In[2166]:=",ExpressionUUID->"43e26709-a0ee-fb4d-9581-f1ea14cca791"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", "3", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"0", ",", "2"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"0", ",", "3"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "3", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", "3", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "4"]]}]], "Output",
 CellChangeTimes->{{3.9391200913022366`*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.9391202079324684`*^9, 3.939120615844591*^9, 
   3.9391207523667297`*^9, {3.939121011448004*^9, 3.939121034429884*^9}},
 CellLabel->
  "Out[2172]=",ExpressionUUID->"70e02f67-e098-9341-a649-e1e59a039226"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{{3.9391200913022366`*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.9391202079324684`*^9, 3.939120615844591*^9, 
   3.9391207523667297`*^9, {3.939121011448004*^9, 3.939121034429884*^9}},
 CellLabel->
  "Out[2173]=",ExpressionUUID->"cfa5fb5d-6361-f145-90dd-d819fdd1dceb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.939121042832838*^9, 3.9391210506901913`*^9}},
 CellLabel->
  "In[2174]:=",ExpressionUUID->"69a43f82-ca57-1441-80bf-33e24774125a"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9391210511946964`*^9},
 CellLabel->
  "Out[2174]=",ExpressionUUID->"9fb46d6e-4dc8-1b47-aa7f-68f5a7129cc1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E.g.3.1) 2x2 square lattice: same as before but 1 absorbs everything. \
CORRECT!!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.9391199184810543`*^9}, {
   3.9391202242272396`*^9, 3.93912026800753*^9}, {3.939120316132612*^9, 
   3.939120370520834*^9}, {3.939120416186205*^9, 3.9391204232540092`*^9}, {
   3.9391207668903694`*^9, 3.9391207907370663`*^9}, {3.939120865256918*^9, 
   3.939120924967476*^9}, 3.9391209911409397`*^9, {3.9391210710001545`*^9, 
   3.9391211032751427`*^9}},ExpressionUUID->"2cf23a1f-8588-4440-9337-\
ec3b1e737975"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "->", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939120033231417*^9, 3.93912009671538*^9}, {
   3.939120143674591*^9, 3.9391202074098396`*^9}, {3.939120375509392*^9, 
   3.9391204070097237`*^9}, {3.939120437494154*^9, 3.939120614655537*^9}, {
   3.9391209294803505`*^9, 3.939120961324808*^9}, {3.9391210030295715`*^9, 
   3.939121033656*^9}, {3.939121107705538*^9, 3.93912110889267*^9}, {
   3.939121165527727*^9, 3.9391211739835625`*^9}, 3.939121277477867*^9, 
   3.9391213226933336`*^9},
 CellLabel->
  "In[2210]:=",ExpressionUUID->"d8a11bcc-572e-6b47-b65f-6f9b7cfa1d91"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{{3.9391200913022366`*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.9391202079324684`*^9, 3.939120615844591*^9, 
   3.9391207523667297`*^9, {3.939121011448004*^9, 3.939121034429884*^9}, 
   3.9391211099822845`*^9, 3.9391211757200413`*^9, {3.9391212785213184`*^9, 
   3.939121285992798*^9}, 3.9391213232578297`*^9},
 CellLabel->
  "Out[2216]=",ExpressionUUID->"d4194b3e-b4df-164f-91b4-a79fdcd05875"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{{3.9391200913022366`*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.9391202079324684`*^9, 3.939120615844591*^9, 
   3.9391207523667297`*^9, {3.939121011448004*^9, 3.939121034429884*^9}, 
   3.9391211099822845`*^9, 3.9391211757200413`*^9, {3.9391212785213184`*^9, 
   3.939121285992798*^9}, 3.9391213232638474`*^9},
 CellLabel->
  "Out[2217]=",ExpressionUUID->"7f68ca21-6f96-1844-9383-f522115dcc93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.939121042832838*^9, 3.9391210506901913`*^9}},
 CellLabel->
  "In[2218]:=",ExpressionUUID->"306f2050-30a1-d243-a8e8-dfe2d161a62c"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9391210511946964`*^9, 3.939121117498598*^9, 
  3.939121192051903*^9, 3.939121281887991*^9, 3.9391213256148567`*^9},
 CellLabel->
  "Out[2218]=",ExpressionUUID->"da604dbe-1675-1247-9318-1cf929c7f68e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E.g.3.2) 2x2 square lattice: same as before but 1 absorbs only from 3. \
CORRECT!!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.9391199184810543`*^9}, {
   3.9391202242272396`*^9, 3.93912026800753*^9}, {3.939120316132612*^9, 
   3.939120370520834*^9}, {3.939120416186205*^9, 3.9391204232540092`*^9}, {
   3.9391207668903694`*^9, 3.9391207907370663`*^9}, {3.939120865256918*^9, 
   3.939120924967476*^9}, 3.9391209911409397`*^9, {3.9391210710001545`*^9, 
   3.939121152060135*^9}},ExpressionUUID->"61c94159-63f8-5341-9856-\
d93ac2d3bd47"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "1"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "l"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "l"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "->", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9391200332314167`*^9, 3.9391200967153797`*^9}, {
   3.939120143674591*^9, 3.9391202074098396`*^9}, {3.939120375509392*^9, 
   3.9391204070097237`*^9}, {3.939120437494154*^9, 3.9391206146555367`*^9}, {
   3.9391209294803505`*^9, 3.939120961324808*^9}, {3.9391210030295715`*^9, 
   3.939121033656*^9}, {3.939121107705538*^9, 3.9391211088926697`*^9}, 
   3.939121275073435*^9, {3.9391213420646114`*^9, 3.9391213680669956`*^9}},
 CellLabel->
  "In[2236]:=",ExpressionUUID->"d6b250c9-9aa9-584e-9b42-a8d8917fb56a"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "4"]]}]], "Output",
 CellChangeTimes->{{3.9391200913022366`*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.9391202079324684`*^9, 3.939120615844591*^9, 
   3.9391207523667297`*^9, {3.939121011448004*^9, 3.939121034429884*^9}, 
   3.9391211099822845`*^9, {3.9391213318081875`*^9, 3.9391213688229675`*^9}},
 CellLabel->
  "Out[2242]=",ExpressionUUID->"31cdffe8-fc53-5441-ac31-857fc9848fa6"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{{3.9391200913022366`*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.9391202079324684`*^9, 3.939120615844591*^9, 
   3.9391207523667297`*^9, {3.939121011448004*^9, 3.939121034429884*^9}, 
   3.9391211099822845`*^9, {3.9391213318081875`*^9, 3.9391213688229675`*^9}},
 CellLabel->
  "Out[2243]=",ExpressionUUID->"3bc96977-b3c7-454b-a024-81700e8a6a6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.939121042832838*^9, 3.9391210506901913`*^9}},
 CellLabel->
  "In[2244]:=",ExpressionUUID->"32d902ce-f1ff-6347-ab19-985341a9cdde"],

Cell[BoxData[
 FractionBox["1", "4"]], "Output",
 CellChangeTimes->{
  3.9391210511946964`*^9, 3.939121117498598*^9, {3.93912135486594*^9, 
   3.939121372034336*^9}},
 CellLabel->
  "Out[2244]=",ExpressionUUID->"5f2b98eb-11d6-d846-a5eb-14f03c0d60d7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We have checked many partition functions. Let\[CloseCurlyQuote]s now check \
the observable U(a,b,c)=sum of the probabilities of all LERWs going from a to \
c and passing through b. \t\t\tCORRECT!!!!\
\>", "Item",
 CellChangeTimes->{{3.9391214313720913`*^9, 3.939121522013119*^9}, {
  3.939181417328535*^9, 
  3.9391814215206604`*^9}},ExpressionUUID->"09f88d79-ca2e-c945-aa7e-\
efb0e4f7fe04"],

Cell[CellGroupData[{

Cell["\<\
e.g.U1.1)Let\[CloseCurlyQuote]s begin with the most simple non-trivial \
example: that with the 3 vertices a b c with self-loop at b and total \
absorption at c. We then want to get the probability of a LERW passing \
through b. The observable is given by the correlator of 4 fields with fixed \
flavour indices.       CORRECT!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.9391215261224346`*^9, 3.939121657260519*^9}, {
  3.9391216926246853`*^9, 3.939121747220539*^9}, {3.939181426268709*^9, 
  3.9391814325884647`*^9}, {3.939181477306015*^9, 3.939181483536522*^9}, {
  3.9398114595759296`*^9, 
  3.9398114597786255`*^9}},ExpressionUUID->"0cd69e85-42c3-234a-8755-\
cfed69381d90"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"c", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"b", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"b", ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"a", ",", "1"}], "]"}], 
    RowBox[{"(*", 
     RowBox[{"From", " ", "a"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"c", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"a", ",", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "7", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"b", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"a", ",", "i"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "b"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "9", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"c", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "13", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"a", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "15", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"b", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[Delta]ruleExternal"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", 
      RowBox[{"\[Beta]", "''"}]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", 
      SubscriptBox["r", "a"]}], ",", "  ", 
     RowBox[{
      RowBox[{"Zeta", "[", "7", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "9", "]"}], "->", 
      RowBox[{"\[Beta]", "'''"}]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "13", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "11", "]"}], "->", 
      SubscriptBox["r", "b"]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "15", "]"}], "->", 
      RowBox[{"\[Beta]", "'"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Now", " ", "normalize", " ", "it", " ", "with", " ", 
    RowBox[{"1", "/", "Z"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", 
   SubscriptBox[
    SuperscriptBox["Z", "u"], "abc"]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["r", "b"], "->", 
      RowBox[{"\[Lambda]", "+", "\[Beta]", "+", 
       RowBox[{"\[Beta]", "'"}], "+", 
       RowBox[{"\[Beta]", "'''"}]}]}], ",", 
     RowBox[{
      SubscriptBox["r", "a"], "->", 
      RowBox[{"\[Lambda]", "+", "\[Beta]", "+", 
       RowBox[{"\[Beta]", "''"}]}]}]}], "}"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]", "''"}], "->", "1"}], ",", " ", 
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{
     RowBox[{"\[Beta]", "'"}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"\[Beta]", "'''"}], "->", "1"}], ",", 
    RowBox[{"\[Lambda]", "->", "1"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.9391217749380493`*^9, 3.939121802200369*^9}, {
  3.939122126101866*^9, 3.939122126798973*^9}, {3.9391229724643497`*^9, 
  3.939122976263193*^9}, {3.9391230267883625`*^9, 3.939123028397297*^9}, {
  3.9391233265683193`*^9, 3.9391234296881466`*^9}, {3.939123505859028*^9, 
  3.939123571761419*^9}, {3.939180025195973*^9, 3.939180029254198*^9}, {
  3.939180183639393*^9, 3.939180284469937*^9}, {3.939181463243608*^9, 
  3.9391814639829907`*^9}, {3.9398112080293465`*^9, 3.9398112087521095`*^9}, {
  3.939811240249197*^9, 3.939811278681814*^9}, {3.939811665599205*^9, 
  3.9398116680987797`*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"fb48d549-3742-d049-a247-e0780461886a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Beta]", " ", 
   SuperscriptBox["\[Beta]", 
    TagBox[
     RowBox[{"(", "3", ")"}],
     Derivative],
    MultilineFunction->None]}], 
  RowBox[{
   SubscriptBox["r", "a"], " ", 
   SubscriptBox["r", "b"]}]]], "Output",
 CellChangeTimes->{
  3.939121803281517*^9, 3.939121871090769*^9, 3.939122063555956*^9, 
   3.9391221279823*^9, 3.9391222775278645`*^9, 3.9391225844356174`*^9, 
   3.939122976743147*^9, 3.939123028948368*^9, {3.9391233338199463`*^9, 
   3.939123381258713*^9}, {3.939123417817821*^9, 3.93912343074988*^9}, {
   3.939123507943138*^9, 3.939123572132443*^9}, {3.939178967389904*^9, 
   3.939178987297457*^9}, 3.939179752031389*^9, 3.939179796151598*^9, {
   3.939180030726992*^9, 3.9391800481687355`*^9}, 3.939180140375365*^9, {
   3.9391802690696545`*^9, 3.939180284818241*^9}, {3.939181445443329*^9, 
   3.939181464332394*^9}, 3.939811280195984*^9, 3.9398116685967712`*^9},
 CellLabel->
  "Out[230]=",ExpressionUUID->"7ab2f898-5f34-d04b-ad9f-b1ab09b692c6"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[Beta]", " ", 
    SuperscriptBox["\[Beta]", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None]}], 
   RowBox[{
    SuperscriptBox["\[Beta]", "2"], "+", 
    RowBox[{
     SubscriptBox["r", "a"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["r", "b"]}], "+", 
       SuperscriptBox["\[Beta]", "\[Prime]",
        MultilineFunction->None]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.939121803281517*^9, 3.939121871090769*^9, 3.939122063555956*^9, 
   3.9391221279823*^9, 3.9391222775278645`*^9, 3.9391225844356174`*^9, 
   3.939122976743147*^9, 3.939123028948368*^9, {3.9391233338199463`*^9, 
   3.939123381258713*^9}, {3.939123417817821*^9, 3.93912343074988*^9}, {
   3.939123507943138*^9, 3.939123572132443*^9}, {3.939178967389904*^9, 
   3.939178987297457*^9}, 3.939179752031389*^9, 3.939179796151598*^9, {
   3.939180030726992*^9, 3.9391800481687355`*^9}, 3.939180140375365*^9, {
   3.9391802690696545`*^9, 3.939180284818241*^9}, {3.939181445443329*^9, 
   3.939181464332394*^9}, 3.939811280195984*^9, 3.9398116686008644`*^9},
 CellLabel->
  "Out[231]=",ExpressionUUID->"a73beb88-1f24-e641-84f8-b88873ea6d82"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Beta]", " ", 
   SuperscriptBox["\[Beta]", 
    TagBox[
     RowBox[{"(", "3", ")"}],
     Derivative],
    MultilineFunction->None]}], 
  RowBox[{
   RowBox[{"\[Lambda]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "\[Beta]"}], "+", "\[Lambda]"}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Beta]", "+", "\[Lambda]"}], ")"}], " ", 
    SuperscriptBox["\[Beta]", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None]}], "+", 
   RowBox[{
    SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
     MultilineFunction->None], " ", 
    RowBox[{"(", 
     RowBox[{"\[Beta]", "+", "\[Lambda]", "+", 
      SuperscriptBox["\[Beta]", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.939121803281517*^9, 3.939121871090769*^9, 3.939122063555956*^9, 
   3.9391221279823*^9, 3.9391222775278645`*^9, 3.9391225844356174`*^9, 
   3.939122976743147*^9, 3.939123028948368*^9, {3.9391233338199463`*^9, 
   3.939123381258713*^9}, {3.939123417817821*^9, 3.93912343074988*^9}, {
   3.939123507943138*^9, 3.939123572132443*^9}, {3.939178967389904*^9, 
   3.939178987297457*^9}, 3.939179752031389*^9, 3.939179796151598*^9, {
   3.939180030726992*^9, 3.9391800481687355`*^9}, 3.939180140375365*^9, {
   3.9391802690696545`*^9, 3.939180284818241*^9}, {3.939181445443329*^9, 
   3.939181464332394*^9}, 3.939811280195984*^9, 3.9398116686038857`*^9},
 CellLabel->
  "Out[232]=",ExpressionUUID->"90aefd15-11d5-c34d-a833-3d77137d889b"],

Cell[BoxData[
 FractionBox["1", "8"]], "Output",
 CellChangeTimes->{
  3.939121803281517*^9, 3.939121871090769*^9, 3.939122063555956*^9, 
   3.9391221279823*^9, 3.9391222775278645`*^9, 3.9391225844356174`*^9, 
   3.939122976743147*^9, 3.939123028948368*^9, {3.9391233338199463`*^9, 
   3.939123381258713*^9}, {3.939123417817821*^9, 3.93912343074988*^9}, {
   3.939123507943138*^9, 3.939123572132443*^9}, {3.939178967389904*^9, 
   3.939178987297457*^9}, 3.939179752031389*^9, 3.939179796151598*^9, {
   3.939180030726992*^9, 3.9391800481687355`*^9}, 3.939180140375365*^9, {
   3.9391802690696545`*^9, 3.939180284818241*^9}, {3.939181445443329*^9, 
   3.939181464332394*^9}, 3.939811280195984*^9, 3.9398116686096535`*^9},
 CellLabel->
  "Out[233]=",ExpressionUUID->"47ac1d5b-02c1-b149-a882-83196709babf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
e.g. U1.2) Now let\[CloseCurlyQuote]s compute the one on the left. In order \
to do so we need a little trick: since we need a point through which the path \
goes, we add a fictitious extra vertex between a and c, which we\
\[CloseCurlyQuote]ll call b\[CloseCurlyQuote]. \t\tCORRECT!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939181468891344*^9, 3.939181573412277*^9}, {
  3.939181977537741*^9, 3.939181985725363*^9}, {3.9398114621845856`*^9, 
  3.9398114622435513`*^9}},ExpressionUUID->"adacadf2-0bd8-e545-9de2-\
540c674467a2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"c", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"a", ",", "1"}], "]"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "a"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"a", ",", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "7", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"b", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"a", ",", "i"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "b"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "9", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"c", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "13", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"a", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "15", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"b", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"b", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"c", ",", "k"}], "]"}], 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "k"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "a_"}], "]"}], "*", 
      RowBox[{"\[Phi]s", "[", 
       RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
     RowBox[{"(", 
      RowBox[{"!", 
       RowBox[{"NumericQ", "[", 
        RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]rule"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[Delta]ruleExternal"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", 
      RowBox[{"\[Beta]", "''"}]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", 
      SubscriptBox["r", "a"]}], ",", "  ", 
     RowBox[{
      RowBox[{"Zeta", "[", "7", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "9", "]"}], "->", 
      RowBox[{"\[Beta]", "'''"}]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "13", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "11", "]"}], "->", 
      SubscriptBox["r", "b"]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "15", "]"}], "->", 
      RowBox[{"\[Beta]", "'"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Now", " ", "normalize", " ", "it", " ", "with", " ", 
    RowBox[{"1", "/", "Z"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", 
   SubscriptBox[
    SuperscriptBox["Z", "u"], "abc"]}], "//", "FullSimplify"}]}], "Input",
 PageWidth->PaperWidth,
 CellChangeTimes->{{3.939181592577593*^9, 3.939181652604529*^9}, {
   3.9398112311171513`*^9, 3.9398112318267517`*^9}, {3.93981129599738*^9, 
   3.939811321059803*^9}, {3.939811522763155*^9, 3.93981152566778*^9}, {
   3.9398116441766376`*^9, 3.9398116511637087`*^9}, {3.939879798737522*^9, 
   3.9398798634844666`*^9}, 3.9398834853035145`*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"e921cbd1-6133-874e-807f-16322a268886"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["r", "b"], "-", 
      SuperscriptBox["\[Beta]", "\[Prime]",
       MultilineFunction->None]}], ")"}], " ", 
    SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
     MultilineFunction->None]}], 
   RowBox[{
    SuperscriptBox["\[Beta]", "2"], "+", 
    RowBox[{
     SubscriptBox["r", "a"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["r", "b"]}], "+", 
       SuperscriptBox["\[Beta]", "\[Prime]",
        MultilineFunction->None]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.939181655750939*^9, {3.939811311744243*^9, 3.939811321531311*^9}, 
   3.939811526128769*^9, 3.939811657817087*^9, 3.939879867467495*^9, 
   3.9398799206574993`*^9, 3.9398834735029736`*^9, 
   3.93988351939616*^9},ExpressionUUID->"3da7a3b4-13ca-f840-8750-\
725bd736b542"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "b"], "->", 
        RowBox[{"\[Lambda]", "+", "\[Beta]", "+", 
         RowBox[{"\[Beta]", "'"}], "+", 
         RowBox[{"\[Beta]", "'''"}]}]}], ",", 
       RowBox[{
        SubscriptBox["r", "a"], "->", 
        RowBox[{"\[Lambda]", "+", "\[Beta]", "+", 
         RowBox[{"\[Beta]", "''"}]}]}]}], "}"}]}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]", "''"}], "->", "1"}], ",", " ", 
       RowBox[{"\[Beta]", "->", "1"}], ",", 
       RowBox[{
        RowBox[{"\[Beta]", "'"}], "->", "1"}], ",", 
       RowBox[{
        RowBox[{"\[Beta]", "'''"}], "->", "1"}], ",", 
       RowBox[{"\[Lambda]", "->", "1"}]}], "}"}]}], "*)"}]}]}]], "Input",Expre\
ssionUUID->"d3d880ce-6991-de45-b7b5-47f5ab0d29b2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
    MultilineFunction->None], " ", 
   RowBox[{"(", 
    RowBox[{"\[Beta]", "+", "\[Lambda]", "+", 
     SuperscriptBox["\[Beta]", 
      TagBox[
       RowBox[{"(", "3", ")"}],
       Derivative],
      MultilineFunction->None]}], ")"}]}], 
  RowBox[{
   RowBox[{"\[Lambda]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "\[Beta]"}], "+", "\[Lambda]"}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Beta]", "+", "\[Lambda]"}], ")"}], " ", 
    SuperscriptBox["\[Beta]", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None]}], "+", 
   RowBox[{
    SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
     MultilineFunction->None], " ", 
    RowBox[{"(", 
     RowBox[{"\[Beta]", "+", "\[Lambda]", "+", 
      SuperscriptBox["\[Beta]", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.939181655750939*^9, {3.9398113117442436`*^9, 3.939811321531311*^9}, 
   3.939811526128769*^9, 3.9398116578251743`*^9},
 CellLabel->
  "Out[221]=",ExpressionUUID->"b29efe5c-ed2e-e241-a139-af5959bfcd8d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
e.g.U2.0) Now let\[CloseCurlyQuote]s try with something a little more \
complex: 2x2 square lattice with total absorption at 1.\
\>", "Subitem",
 CellChangeTimes->{{3.9391819899725876`*^9, 3.93918205437681*^9}, {
  3.9398932448535175`*^9, 3.9398932449533443`*^9}, {3.939893308812788*^9, 
  3.939893308885271*^9}},ExpressionUUID->"8553ac77-6161-2949-abd4-\
688b7afc2120"],

Cell[CellGroupData[{

Cell["\<\
Let\[CloseCurlyQuote]s start by defining the partition function: recall \
e.g.3.1\
\>", "Subsubitem",
 CellChangeTimes->{{3.9391820569564037`*^9, 
  3.939182104103937*^9}},ExpressionUUID->"4827bca4-adc6-d74a-b0b6-\
310c16fe26f8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Z", "=", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939182110271591*^9, 3.939182117720415*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"8717c0a9-cd31-f24d-8067-90f46f7bd087"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{
  3.939182118069439*^9, 3.939184758252136*^9, 3.9391848087843237`*^9, {
   3.939893361669428*^9, 3.9398933824070816`*^9}},
 CellLabel->"Out[96]=",ExpressionUUID->"6239f7b8-189f-d544-9857-8f9ed539bb1d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U2.1)Now define the observable U: let\[CloseCurlyQuote]s start with the \
probability to get the path 01. As in e.g. U1.1, we need the trick of an \
extra vertex between 0 and 1.\t\tCORRECT!!!!!\
\>", "Subsubitem",
 CellChangeTimes->{{3.939182131435692*^9, 3.939182194165268*^9}, {
  3.93918223418058*^9, 3.939182275317379*^9}, {3.9391828818546333`*^9, 
  3.939182902689361*^9}, {3.9398932470366325`*^9, 
  3.939893247409258*^9}},ExpressionUUID->"50e7fd92-007d-0c47-8a2c-\
ea2f3bfdfb11"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"0", ",", "1"}], "]"}], 
    RowBox[{"(*", 
     RowBox[{"From", " ", "0"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "2"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "3"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"b", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "l"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "l"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", "\[Delta]ruleExternalMod"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "Z"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939182210874214*^9, 3.939182230019455*^9}, {
   3.939182281291044*^9, 3.9391823740334167`*^9}, {3.939182408594867*^9, 
   3.9391824226832523`*^9}, {3.9391825573680687`*^9, 3.9391825578699512`*^9}, 
   3.939182628835964*^9, {3.939182773283504*^9, 3.939182780813949*^9}, {
   3.939182847481638*^9, 3.93918285911738*^9}, {3.939183149879507*^9, 
   3.939183151800907*^9}, {3.939893407048233*^9, 3.9398934136556187`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"e11c4b1f-2e0e-e848-8388-4002a1a9446c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r", "-", "\[Beta]"}], ")"}], " ", "\[Beta]", " ", 
   RowBox[{"(", 
    RowBox[{"r", "+", "\[Beta]"}], ")"}]}], 
  RowBox[{
   SuperscriptBox["r", "3"], "-", 
   RowBox[{"2", " ", "r", " ", 
    SuperscriptBox["\[Beta]", "2"]}]}]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.9391827749319158`*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, 3.939183152181364*^9, {
   3.939893384773638*^9, 3.9398934140069847`*^9}},
 CellLabel->
  "Out[125]=",ExpressionUUID->"2465829b-82be-f14f-b9da-b3d5dc5e26fc"],

Cell[BoxData[
 FractionBox["3", "4"]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.9391827749319158`*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, 3.939183152181364*^9, {
   3.939893384773638*^9, 3.939893414013996*^9}},
 CellLabel->
  "Out[126]=",ExpressionUUID->"8fa81f4e-2cfe-5445-be54-c6951721651f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U2.2)Now define the observable U for the probability to get the path 0231. \t\
\tCORRECT!!!!!\
\>", "Subsubitem",
 CellChangeTimes->{{3.939182131435692*^9, 3.939182194165268*^9}, {
  3.93918223418058*^9, 3.939182275317379*^9}, {3.9391828818546333`*^9, 
  3.93918293796421*^9}, {3.9398932507914333`*^9, 
  3.9398932509086*^9}},ExpressionUUID->"fbb20c4e-fe6e-b049-aabc-c68507587a5c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"3", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"0", ",", "1"}], "]"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "0"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "2"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "3"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"b", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "l"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "l"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[Delta]ruleExternal"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "Z"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939182210874214*^9, 3.939182230019455*^9}, {
   3.939182281291044*^9, 3.9391823740334167`*^9}, {3.9391824085948677`*^9, 
   3.9391824226832523`*^9}, {3.9391825573680687`*^9, 3.9391825578699512`*^9}, 
   3.939182628835964*^9, {3.9391827732835045`*^9, 3.9391827808139496`*^9}, {
   3.939182847481638*^9, 3.93918285911738*^9}, {3.9391829441877975`*^9, 
   3.939182994914551*^9}, {3.9391831317130985`*^9, 3.93918316084577*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"b4c8ab98-563a-d041-8313-3e5b4080480f"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
   RowBox[{"D\[Delta]", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"D\[Delta]", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"D\[Delta]", "[", "3", "]"}], "2"], " ", 
   RowBox[{"D\[Delta]", "[", 
    RowBox[{"1", ",", "3"}], "]"}], " ", 
   RowBox[{"D\[Delta]", "[", 
    RowBox[{"2", ",", "0"}], "]"}], " ", 
   RowBox[{"D\[Delta]", "[", 
    RowBox[{"3", ",", "2"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Zeta", "[", "5", "]"}], "3"]}], 
  SuperscriptBox[
   RowBox[{"Zeta", "[", "3", "]"}], "3"]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, {3.939182982572281*^9, 
   3.9391829952143364`*^9}, 3.9391831614136124`*^9},
 CellLabel->
  "Out[279]=",ExpressionUUID->"ec2cf314-36f2-a848-a812-8f8c7d90a587"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[Beta]", "3"], 
  RowBox[{
   SuperscriptBox["r", "3"], "-", 
   RowBox[{"2", " ", "r", " ", 
    SuperscriptBox["\[Beta]", "2"]}]}]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, {3.939182982572281*^9, 
   3.9391829952143364`*^9}, 3.9391831614136124`*^9},
 CellLabel->
  "Out[282]=",ExpressionUUID->"8e68b88e-4454-a54e-ab83-d505e4241b23"],

Cell[BoxData[
 FractionBox["1", "4"]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, {3.939182982572281*^9, 
   3.9391829952143364`*^9}, 3.9391831614136124`*^9},
 CellLabel->
  "Out[283]=",ExpressionUUID->"c6647c5f-9f2f-2746-be14-4f49eb5699c2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U2.3)Now define the observable U for the probability to get the path 231. \t\t\
CORRECT!!!!!\
\>", "Subsubitem",
 CellChangeTimes->{{3.939182131435692*^9, 3.939182194165268*^9}, {
  3.93918223418058*^9, 3.939182275317379*^9}, {3.9391828818546333`*^9, 
  3.93918293796421*^9}, {3.93918477149016*^9, 3.9391847755848217`*^9}, {
  3.9398932541854973`*^9, 
  3.9398932549062195`*^9}},ExpressionUUID->"f4fa26c4-3d9e-604e-a2ad-\
6934014d3152"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"3", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "0"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "2"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "3"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", "\[Delta]ruleExternal"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "Z"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939182210874214*^9, 3.939182230019455*^9}, {
   3.939182281291044*^9, 3.9391823740334167`*^9}, {3.9391824085948677`*^9, 
   3.9391824226832523`*^9}, {3.9391825573680687`*^9, 3.9391825578699512`*^9}, 
   3.939182628835964*^9, {3.9391827732835045`*^9, 3.9391827808139496`*^9}, {
   3.939182847481638*^9, 3.93918285911738*^9}, {3.9391829441877975`*^9, 
   3.939182994914551*^9}, {3.9391831317130985`*^9, 3.93918316084577*^9}, {
   3.9391847797843857`*^9, 3.9391848309468174`*^9}, {3.939184865995825*^9, 
   3.939184875986511*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"a33ae952-3835-b947-a9fd-202a9eec3c2d"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[Beta]", "2"], 
  RowBox[{
   SuperscriptBox["r", "2"], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[Beta]", "2"]}]}]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, {3.939182982572281*^9, 
   3.9391829952143364`*^9}, 3.9391831614136124`*^9, {3.939184787725231*^9, 
   3.9391848023156834`*^9}, {3.9391848624715786`*^9, 3.9391848761915016`*^9}},
 CellLabel->
  "Out[431]=",ExpressionUUID->"a0c23b2d-b641-4249-91e8-ac4f465cbfc4"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, {3.939182982572281*^9, 
   3.9391829952143364`*^9}, 3.9391831614136124`*^9, {3.939184787725231*^9, 
   3.9391848023156834`*^9}, {3.9391848624715786`*^9, 3.9391848761915016`*^9}},
 CellLabel->
  "Out[432]=",ExpressionUUID->"d2b69fe2-2a3c-8947-8fd7-1db06cf2c4f6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
e.g.U3) Now even more complex: 3x3 square lattice with total absorption at 4 \
(the vertex in the center).\
\>", "Subitem",
 CellChangeTimes->{{3.9391819899725876`*^9, 3.93918205437681*^9}, {
  3.939183402330759*^9, 
  3.9391834403447495`*^9}},ExpressionUUID->"a8ad6383-460c-1949-96ab-\
6a88ab777456"],

Cell[CellGroupData[{

Cell["Let\[CloseCurlyQuote]s start by defining the partition function: ", \
"Subsubitem",
 CellChangeTimes->{{3.9391820569564037`*^9, 3.939182104103937*^9}, {
  3.939183444567276*^9, 
  3.939183444721752*^9}},ExpressionUUID->"8a566e29-c1b3-c14e-88a5-\
c540ee416bca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i0"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i0"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "i0"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i0"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "1"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i2"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "i2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"5", ",", "i2"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "i2"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"6", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "5"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"8", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "6"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "i6"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"6", ",", "i6"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"7", ",", "i6"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"6", ",", "i6"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "7"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"6", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"8", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "8"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"7", ",", "i8"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"8", ",", "i8"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"5", ",", "i8"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"8", ",", "i8"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "3", "]"}], "->", "r2"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "7", "]"}], "->", "r3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Z", "=", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939182110271591*^9, 3.939182117720415*^9}, {
   3.9391834585799904`*^9, 3.9391837402345715`*^9}, 3.93918411011722*^9, {
   3.939184150814396*^9, 3.939184201941395*^9}, {3.939184250661186*^9, 
   3.939184260306963*^9}, 3.9391850983113403`*^9, {3.93918513021941*^9, 
   3.9391851322811813`*^9}, {3.93918544114534*^9, 3.93918545026754*^9}, {
   3.9391854863213177`*^9, 3.939185487288252*^9}, {3.93918556002746*^9, 
   3.9391855610523453`*^9}},
 CellLabel->
  "In[479]:=",ExpressionUUID->"9bf57419-8f49-d540-b265-ff7eea825cfe"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"8", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   RowBox[{"r2", " ", "r3"}]], "+", 
  FractionBox[
   RowBox[{"20", " ", 
    SuperscriptBox["\[Beta]", "4"]}], 
   RowBox[{
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "2"]}]], "-", 
  FractionBox[
   RowBox[{"16", " ", 
    SuperscriptBox["\[Beta]", "6"]}], 
   RowBox[{
    SuperscriptBox["r2", "3"], " ", 
    SuperscriptBox["r3", "3"]}]]}]], "Output",
 CellChangeTimes->{
  3.939182118069439*^9, 3.939183749972637*^9, 3.9391841171469154`*^9, 
   3.9391842092995625`*^9, 3.939185019229126*^9, 3.9391851020363083`*^9, 
   3.9391851363027134`*^9, {3.9391854505499134`*^9, 3.9391854912518444`*^9}, 
   3.939185565057417*^9},
 CellLabel->
  "Out[485]=",ExpressionUUID->"29a7c73d-4a32-614c-ba1f-f42d79638bf7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "%"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r2", "->", "2"}], ",", 
    RowBox[{"r3", "->", "3"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9391842662853374`*^9, 3.9391842673531094`*^9}},
 CellLabel->
  "In[471]:=",ExpressionUUID->"be3d8018-4699-8048-aed3-825cdd74f85c"],

Cell[BoxData[
 FractionBox["16", "729"]], "Output",
 CellChangeTimes->{3.9391842680450172`*^9, 3.9391854797855186`*^9},
 CellLabel->
  "Out[471]=",ExpressionUUID->"19189c00-4d2d-9a43-9254-86ed8894c5c8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U3.1)Now define the observable U: let\[CloseCurlyQuote]s start with the \
probability to get the path 014. As in e.g. U1.1, we need the trick of an \
extra vertex between 0 and 1 and 1 and 4.\t\tCORRECT!!!!! \
CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!\
\>", "Subsubitem",
 CellChangeTimes->{{3.939182131435692*^9, 3.939182194165268*^9}, {
  3.93918223418058*^9, 3.939182275317379*^9}, {3.9391828818546333`*^9, 
  3.9391829026893616`*^9}, {3.9391838032228374`*^9, 3.939183810189192*^9}, {
  3.939185604416374*^9, 3.939185606736088*^9}, {3.939186671366974*^9, 
  3.939186672599283*^9}},ExpressionUUID->"f83500ec-da75-344f-9572-\
76d9879c7185"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"4", ",", "4"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"c", "'"}], ",", "4"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"c", "'"}], ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"0", ",", "1"}], "]"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "0"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "i0"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i0"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "i0"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i0"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "1"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"c", "'"}], ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "2"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "i2"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "i2"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"5", ",", "i2"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "i2"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "3"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"6", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "5"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"8", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "6"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "i6"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"6", ",", "i6"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"7", ",", "i6"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"6", ",", "i6"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "7"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"6", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"8", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "8"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"7", ",", "i8"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"8", ",", "i8"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"5", ",", "i8"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"8", ",", "i8"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"b", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "l"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "l"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"c", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"c", "'"}], ",", "i"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", "\[Delta]ruleExternal"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", "r2"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "7", "]"}], "->", "r3"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "Z"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r2", "->", "2"}], ",", 
    RowBox[{"r3", "->", "3"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939182210874214*^9, 3.939182230019455*^9}, {
   3.939182281291044*^9, 3.9391823740334167`*^9}, {3.9391824085948677`*^9, 
   3.9391824226832523`*^9}, {3.9391825573680687`*^9, 3.9391825578699512`*^9}, 
   3.939182628835964*^9, {3.9391827732835045`*^9, 3.9391827808139496`*^9}, {
   3.939182847481638*^9, 3.93918285911738*^9}, {3.939183149879507*^9, 
   3.939183151800907*^9}, {3.9391838391244164`*^9, 3.9391838408345985`*^9}, {
   3.9391838789042416`*^9, 3.9391839400623074`*^9}, {3.9391840317185*^9, 
   3.9391840329435177`*^9}, 3.9391840647420197`*^9, {3.9391842744922714`*^9, 
   3.939184337752743*^9}, {3.9391856172441826`*^9, 3.9391856662187214`*^9}},
 CellLabel->
  "In[486]:=",ExpressionUUID->"812706c6-d56b-4f47-94f5-78a8639f5005"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["r2", "3"], " ", 
    SuperscriptBox["r3", "3"], " ", 
    SuperscriptBox["\[Beta]", "2"]}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "2"], " ", 
    SuperscriptBox["\[Beta]", "4"]}], "+", 
   RowBox[{"6", " ", "r2", " ", "r3", " ", 
    SuperscriptBox["\[Beta]", "6"]}], "-", 
   SuperscriptBox["\[Beta]", "8"]}], 
  RowBox[{"r2", " ", "r3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r2", " ", "r3"}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["\[Beta]", "2"]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r2", " ", "r3"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Beta]", "2"]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, 3.939183152181364*^9, 
   3.9391839140119877`*^9, 3.939183974496311*^9, 3.939184059322275*^9, 
   3.9391841029884243`*^9, 3.9391843675125923`*^9, 3.9391857325356636`*^9},
 CellLabel->
  "Out[494]=",ExpressionUUID->"3e0be7dd-4679-cf49-94b6-34beed9bf76b"],

Cell[BoxData[
 FractionBox["71", "192"]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, 3.939183152181364*^9, 
   3.9391839140119877`*^9, 3.939183974496311*^9, 3.939184059322275*^9, 
   3.9391841029884243`*^9, 3.9391843675125923`*^9, 3.9391857325436287`*^9},
 CellLabel->
  "Out[495]=",ExpressionUUID->"ec6bbcf7-b3a7-6a40-941e-ee17a9d4ef60"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
e.g.U4)  3x3 square lattice with total absorption at 8 (a vertex in the \
corner).\
\>", "Subitem",
 CellChangeTimes->{{3.9391819899725876`*^9, 3.93918205437681*^9}, {
  3.939183402330759*^9, 3.9391834403447495`*^9}, {3.939189109542589*^9, 
  3.9391891274649887`*^9}},ExpressionUUID->"b455b96b-4427-fa42-9e37-\
4e9236061472"],

Cell[CellGroupData[{

Cell["Let\[CloseCurlyQuote]s start by defining the partition function: ", \
"Subsubitem",
 CellChangeTimes->{{3.9391820569564037`*^9, 3.939182104103937*^9}, {
  3.939183444567276*^9, 
  3.939183444721752*^9}},ExpressionUUID->"6b9e2fd7-9424-8141-890a-\
ae33722dbbce"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i0"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i0"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "i0"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i0"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "1"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i2"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "i2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"5", ",", "i2"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "i2"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"6", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "4"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "9", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i4"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"4", ",", "i4"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "9", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "i4"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"4", ",", "i4"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "9", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"5", ",", "i4"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"4", ",", "i4"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "9", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"7", ",", "i4"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"4", ",", "i4"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "5"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"8", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "6"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "i6"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"6", ",", "i6"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"7", ",", "i6"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"6", ",", "i6"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "7"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"6", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"8", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "3", "]"}], "->", "r2"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "7", "]"}], "->", "r3"}], ",", " ", 
       RowBox[{
        RowBox[{"Zeta", "[", "9", "]"}], "->", "r4"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Z", "=", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939182110271591*^9, 3.939182117720415*^9}, {
   3.939183458579991*^9, 3.939183740234572*^9}, 3.93918411011722*^9, {
   3.939184150814396*^9, 3.939184201941395*^9}, {3.939184250661186*^9, 
   3.939184260306963*^9}, 3.9391850983113403`*^9, {3.93918513021941*^9, 
   3.939185132281181*^9}, {3.93918544114534*^9, 3.93918545026754*^9}, {
   3.939185486321318*^9, 3.939185487288252*^9}, {3.93918556002746*^9, 
   3.9391855610523458`*^9}, {3.939189139829271*^9, 3.939189234708452*^9}, {
   3.939189267653012*^9, 3.93918927101326*^9}, 3.9397057450750847`*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"1c083c4d-58a9-154f-a306-5520853d16bf"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"6", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   RowBox[{"r2", " ", "r3"}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   RowBox[{"r3", " ", "r4"}]], "+", 
  FractionBox[
   RowBox[{"10", " ", 
    SuperscriptBox["\[Beta]", "4"]}], 
   RowBox[{
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "2"]}]], "+", 
  FractionBox[
   RowBox[{"12", " ", 
    SuperscriptBox["\[Beta]", "4"]}], 
   RowBox[{"r2", " ", 
    SuperscriptBox["r3", "2"], " ", "r4"}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["\[Beta]", "6"]}], 
   RowBox[{
    SuperscriptBox["r2", "3"], " ", 
    SuperscriptBox["r3", "3"]}]], "-", 
  FractionBox[
   RowBox[{"8", " ", 
    SuperscriptBox["\[Beta]", "6"]}], 
   RowBox[{
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "3"], " ", "r4"}]]}]], "Output",
 CellChangeTimes->{
  3.939182118069439*^9, 3.939183749972637*^9, 3.939184117146916*^9, 
   3.9391842092995625`*^9, 3.939185019229126*^9, 3.9391851020363083`*^9, 
   3.9391851363027134`*^9, {3.9391854505499134`*^9, 3.939185491251844*^9}, 
   3.939185565057417*^9, {3.9391892505827446`*^9, 3.939189278107697*^9}, 
   3.939705732400091*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"7f5442fa-5ac9-964b-9e63-d47456addfc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "%"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r2", "->", "2"}], ",", 
    RowBox[{"r3", "->", "3"}], ",", 
    RowBox[{"r4", "->", "4"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9391842662853384`*^9, 3.9391842673531094`*^9}, {
  3.939189237648411*^9, 3.939189241403975*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"13e31e42-20fa-bc45-80bd-5e4e05a65170"],

Cell[BoxData[
 FractionBox["4", "729"]], "Output",
 CellChangeTimes->{
  3.9391842680450177`*^9, 3.939185479785518*^9, {3.939189252750128*^9, 
   3.939189281988809*^9}, 3.93970573621455*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"be9ad53e-5ecc-db46-a5fd-b73ee4c4dc91"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U4.1)Now define the observable U: let\[CloseCurlyQuote]s start with the \
probability to get the path 01478. As in e.g. U1.1, we need the trick of an \
extra vertex between 0 and 1 and 1 and 4.\t\tCORRECT!!!!! \
CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!\
\>", "Subsubitem",
 CellChangeTimes->{{3.939182131435692*^9, 3.939182194165268*^9}, {
  3.93918223418058*^9, 3.939182275317379*^9}, {3.9391828818546333`*^9, 
  3.9391829026893616`*^9}, {3.9391838032228374`*^9, 3.939183810189192*^9}, {
  3.939185604416374*^9, 3.939185606736088*^9}, {3.939186671366974*^9, 
  3.939186672599283*^9}, {3.939189292774023*^9, 
  3.9391893019780064`*^9}},ExpressionUUID->"dab72dd3-f296-a547-ae5c-\
23d82e9dc0c3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"7", ",", "4"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"c", "'"}], ",", "5"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"7", ",", "5"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"c", "'"}], ",", "5"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"c", "'"}], ",", "4"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"4", ",", "4"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"4", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"0", ",", "1"}], "]"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "0"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "i0"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i0"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "i0"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i0"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "1"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"c", "'"}], ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "2"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "i2"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "i2"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"5", ",", "i2"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "i2"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "3"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"6", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "5"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"8", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "6"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "i6"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"6", ",", "i6"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"7", ",", "i6"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"6", ",", "i6"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "7"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"6", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"8", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "8"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"7", ",", "i8"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"8", ",", "i8"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"5", ",", "i8"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"8", ",", "i8"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"b", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "l"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "l"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"c", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"c", "'"}], ",", "i"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", "\[Delta]ruleExternal"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", "r2"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "7", "]"}], "->", "r3"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "Z"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r2", "->", "2"}], ",", 
    RowBox[{"r3", "->", "3"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939182210874214*^9, 3.939182230019455*^9}, {
   3.939182281291044*^9, 3.9391823740334167`*^9}, {3.9391824085948677`*^9, 
   3.9391824226832523`*^9}, {3.9391825573680687`*^9, 3.9391825578699512`*^9}, 
   3.939182628835964*^9, {3.9391827732835045`*^9, 3.9391827808139496`*^9}, {
   3.939182847481638*^9, 3.93918285911738*^9}, {3.939183149879507*^9, 
   3.939183151800907*^9}, {3.9391838391244164`*^9, 3.9391838408345985`*^9}, {
   3.9391838789042416`*^9, 3.9391839400623074`*^9}, {3.9391840317185*^9, 
   3.9391840329435177`*^9}, 3.9391840647420197`*^9, {3.9391842744922714`*^9, 
   3.939184337752743*^9}, {3.9391856172441826`*^9, 3.9391856662187214`*^9}, {
   3.939189446688919*^9, 
   3.9391895287014713`*^9}},ExpressionUUID->"79ceda6c-ad2d-5349-b1ec-\
e251df942bf4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["r2", "3"], " ", 
    SuperscriptBox["r3", "3"], " ", 
    SuperscriptBox["\[Beta]", "2"]}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "2"], " ", 
    SuperscriptBox["\[Beta]", "4"]}], "+", 
   RowBox[{"6", " ", "r2", " ", "r3", " ", 
    SuperscriptBox["\[Beta]", "6"]}], "-", 
   SuperscriptBox["\[Beta]", "8"]}], 
  RowBox[{"r2", " ", "r3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r2", " ", "r3"}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["\[Beta]", "2"]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r2", " ", "r3"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Beta]", "2"]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, 3.939183152181364*^9, 
   3.9391839140119877`*^9, 3.939183974496311*^9, 3.939184059322275*^9, 
   3.9391841029884243`*^9, 3.9391843675125923`*^9, 3.9391857325356636`*^9},
 CellLabel->
  "Out[494]=",ExpressionUUID->"c354b90c-a3e9-254e-93c7-8f3dda96d18f"],

Cell[BoxData[
 FractionBox["71", "192"]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, 3.939183152181364*^9, 
   3.9391839140119877`*^9, 3.939183974496311*^9, 3.939184059322275*^9, 
   3.9391841029884243`*^9, 3.9391843675125923`*^9, 3.9391857325436287`*^9},
 CellLabel->
  "Out[495]=",ExpressionUUID->"fe449c6e-172e-cf46-9edd-6ca832af73bf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1152, 579.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
CellContext->Notebook,
Magnification:>0.8 Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b1f16191-099a-3f4d-82be-d8ee8f67dcdd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 533, 9, 25, "Item",ExpressionUUID->"79ff84b5-8f52-354a-8abb-0141ba4fffee"],
Cell[1116, 33, 523, 9, 20, "Subsubitem",ExpressionUUID->"539045f2-e12e-f740-a199-c241b5b317fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1676, 47, 349, 5, 25, "Item",ExpressionUUID->"31116618-da27-1d4a-85a6-754212ab01f6"],
Cell[2028, 54, 607, 14, 22, "Subitem",ExpressionUUID->"fedbeb3d-3112-1f4b-9df1-67ec93f26a6a"],
Cell[2638, 70, 825, 13, 39, "Subitem",ExpressionUUID->"07b41a31-a66d-b94f-8038-5ec3cb977be5"],
Cell[CellGroupData[{
Cell[3488, 87, 584, 10, 22, "Subitem",ExpressionUUID->"2aa48082-2775-ef43-b8df-87e820637338"],
Cell[4075, 99, 722, 15, 38, "Input",ExpressionUUID->"26d07459-8f8c-0b4c-98da-5920d2d2e881"],
Cell[CellGroupData[{
Cell[4822, 118, 1039, 27, 54, "Input",ExpressionUUID->"0b794d01-a48c-684b-bfab-b10bb6379e2f"],
Cell[5864, 147, 730, 20, 25, "Output",ExpressionUUID->"ccc6380b-8315-9f48-9d19-c7124ade7500"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6643, 173, 278, 5, 22, "Subitem",ExpressionUUID->"b171f651-1cd1-c14b-a825-4622ed538a0f"],
Cell[6924, 180, 1965, 48, 38, "Input",ExpressionUUID->"f230b126-0c88-5d45-b8b1-6872d54b7e27"],
Cell[8892, 230, 2233, 54, 54, "Input",ExpressionUUID->"8f0c5aa7-f172-2244-95d1-2a233962f71a"],
Cell[11128, 286, 1777, 39, 38, "Input",ExpressionUUID->"66b2709d-c021-1a4c-9429-5dbd0a0561ac"],
Cell[12908, 327, 431, 11, 22, "Input",ExpressionUUID->"be0fdbc9-33b4-6a40-aaca-9b38b7bda553"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13376, 343, 329, 7, 22, "Subitem",ExpressionUUID->"c0e96f75-58d7-5146-b483-878f45e80c15"],
Cell[13708, 352, 957, 26, 38, "Input",ExpressionUUID->"261adeb5-dab9-2249-94b2-d22287175407"],
Cell[14668, 380, 931, 26, 38, "Input",ExpressionUUID->"5bae1f8b-782e-2145-b382-a133483fd60b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15636, 411, 251, 4, 22, "Subitem",ExpressionUUID->"9ae37851-07b4-ee45-b599-6a9f52e2c880"],
Cell[CellGroupData[{
Cell[15912, 419, 3125, 92, 146, "Input",ExpressionUUID->"c20a91b7-8a7e-ac48-981e-7ce77c901821"],
Cell[19040, 513, 630, 15, 42, "Output",ExpressionUUID->"d6665997-4f93-f449-a680-f01fc35a4d59"],
Cell[19673, 530, 606, 15, 44, "Output",ExpressionUUID->"10d6bf0a-0b6a-cf49-8cd8-63a076d64f4c"],
Cell[20282, 547, 476, 12, 44, "Output",ExpressionUUID->"6c3c7b79-3734-b64f-a963-619774f85b6b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20807, 565, 655, 11, 22, "Subitem",ExpressionUUID->"ae10d59d-ec9c-0a44-bf94-a5d9839ac1c2"],
Cell[CellGroupData[{
Cell[21487, 580, 4265, 122, 145, "Input",ExpressionUUID->"d022a4c7-ba46-ca4f-93a4-78118a84b278"],
Cell[25755, 704, 622, 13, 42, "Output",ExpressionUUID->"08684113-6367-2e4a-90a9-06ddc8385245"],
Cell[26380, 719, 647, 14, 42, "Output",ExpressionUUID->"c26e235b-3941-3645-b942-5178f0e54d58"],
Cell[27030, 735, 575, 12, 42, "Output",ExpressionUUID->"1dba768f-4fb3-9444-b05b-453245e469fa"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27654, 753, 665, 11, 22, "Subitem",ExpressionUUID->"5b9fd806-f94c-5a44-954b-ab372ccb3a73"],
Cell[CellGroupData[{
Cell[28344, 768, 4247, 119, 251, "Input",ExpressionUUID->"30fde334-9436-4d41-a62c-741e1f70b2c9"],
Cell[32594, 889, 725, 16, 44, "Output",ExpressionUUID->"61b93443-8fac-1c44-868b-57557d5e7955"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33356, 910, 484, 13, 22, "Input",ExpressionUUID->"89dcc36f-f472-bd44-9dc5-1cf21f4541e3"],
Cell[33843, 925, 198, 4, 40, "Output",ExpressionUUID->"4d1384b6-8f2a-8941-897f-b1c112fff1dc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34090, 935, 604, 10, 22, "Subitem",ExpressionUUID->"95f6d0ff-e871-a248-8411-f5b605eff070"],
Cell[CellGroupData[{
Cell[34719, 949, 5157, 148, 175, "Input",ExpressionUUID->"43e26709-a0ee-fb4d-9581-f1ea14cca791"],
Cell[39879, 1099, 2852, 79, 77, "Output",ExpressionUUID->"70e02f67-e098-9341-a649-e1e59a039226"],
Cell[42734, 1180, 452, 10, 43, "Output",ExpressionUUID->"cfa5fb5d-6361-f145-90dd-d819fdd1dceb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43223, 1195, 307, 8, 22, "Input",ExpressionUUID->"69a43f82-ca57-1441-80bf-33e24774125a"],
Cell[43533, 1205, 156, 3, 25, "Output",ExpressionUUID->"9fb46d6e-4dc8-1b47-aa7f-68f5a7129cc1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43738, 1214, 567, 10, 22, "Subitem",ExpressionUUID->"2cf23a1f-8588-4440-9337-ec3b1e737975"],
Cell[CellGroupData[{
Cell[44330, 1228, 4561, 129, 160, "Input",ExpressionUUID->"d8a11bcc-572e-6b47-b65f-6f9b7cfa1d91"],
Cell[48894, 1359, 936, 22, 43, "Output",ExpressionUUID->"d4194b3e-b4df-164f-91b4-a79fdcd05875"],
Cell[49833, 1383, 580, 12, 43, "Output",ExpressionUUID->"7f68ca21-6f96-1844-9383-f522115dcc93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50450, 1400, 307, 8, 22, "Input",ExpressionUUID->"306f2050-30a1-d243-a8e8-dfe2d161a62c"],
Cell[50760, 1410, 269, 5, 40, "Output",ExpressionUUID->"da604dbe-1675-1247-9318-1cf929c7f68e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51078, 1421, 566, 10, 22, "Subitem",ExpressionUUID->"61c94159-63f8-5341-9856-d93ac2d3bd47"],
Cell[CellGroupData[{
Cell[51669, 1435, 4990, 141, 175, "Input",ExpressionUUID->"d6b250c9-9aa9-584e-9b42-a8d8917fb56a"],
Cell[56662, 1578, 1884, 50, 43, "Output",ExpressionUUID->"31cdffe8-fc53-5441-ac31-857fc9848fa6"],
Cell[58549, 1630, 530, 11, 43, "Output",ExpressionUUID->"3bc96977-b3c7-454b-a024-81700e8a6a6d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59116, 1646, 307, 8, 22, "Input",ExpressionUUID->"32d902ce-f1ff-6347-ab19-985341a9cdde"],
Cell[59426, 1656, 250, 6, 40, "Output",ExpressionUUID->"5f2b98eb-11d6-d846-a5eb-14f03c0d60d7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59737, 1669, 402, 8, 25, "Item",ExpressionUUID->"09f88d79-ca2e-c945-aa7e-efb0e4f7fe04"],
Cell[CellGroupData[{
Cell[60164, 1681, 686, 12, 39, "Subitem",ExpressionUUID->"0cd69e85-42c3-234a-8755-cfed69381d90"],
Cell[CellGroupData[{
Cell[60875, 1697, 6243, 180, 223, "Input",ExpressionUUID->"fb48d549-3742-d049-a247-e0780461886a"],
Cell[67121, 1879, 1017, 22, 44, "Output",ExpressionUUID->"7ab2f898-5f34-d04b-ad9f-b1ab09b692c6"],
Cell[68141, 1903, 1257, 30, 45, "Output",ExpressionUUID->"a73beb88-1f24-e641-84f8-b88873ea6d82"],
Cell[69401, 1935, 1622, 42, 47, "Output",ExpressionUUID->"90aefd15-11d5-c34d-a833-3d77137d889b"],
Cell[71026, 1979, 803, 13, 40, "Output",ExpressionUUID->"47ac1d5b-02c1-b149-a882-83196709babf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71878, 1998, 538, 9, 39, "Subitem",ExpressionUUID->"adacadf2-0bd8-e545-9de2-540c674467a2"],
Cell[CellGroupData[{
Cell[72441, 2011, 5177, 150, 344, "Input",ExpressionUUID->"e921cbd1-6133-874e-807f-16322a268886"],
Cell[77621, 2163, 897, 26, 43, "Output",ExpressionUUID->"3da7a3b4-13ca-f840-8750-725bd736b542"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78555, 2194, 997, 29, 54, "Input",ExpressionUUID->"d3d880ce-6991-de45-b7b5-47f5ab0d29b2"],
Cell[79555, 2225, 1245, 39, 48, "Output",ExpressionUUID->"b29efe5c-ed2e-e241-a139-af5959bfcd8d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[80849, 2270, 380, 7, 22, "Subitem",ExpressionUUID->"8553ac77-6161-2949-abd4-688b7afc2120"],
Cell[CellGroupData[{
Cell[81254, 2281, 239, 6, 20, "Subsubitem",ExpressionUUID->"4827bca4-adc6-d74a-b0b6-310c16fe26f8"],
Cell[CellGroupData[{
Cell[81518, 2291, 4217, 124, 160, "Input",ExpressionUUID->"8717c0a9-cd31-f24d-8067-90f46f7bd087"],
Cell[85738, 2417, 374, 9, 43, "Output",ExpressionUUID->"6239f7b8-189f-d544-9857-8f9ed539bb1d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[86161, 2432, 497, 9, 20, "Subsubitem",ExpressionUUID->"50e7fd92-007d-0c47-8a2c-ea2f3bfdfb11"],
Cell[CellGroupData[{
Cell[86683, 2445, 5593, 166, 221, "Input",ExpressionUUID->"e11c4b1f-2e0e-e848-8388-4002a1a9446c"],
Cell[92279, 2613, 656, 16, 42, "Output",ExpressionUUID->"2465829b-82be-f14f-b9da-b3d5dc5e26fc"],
Cell[92938, 2631, 391, 7, 40, "Output",ExpressionUUID->"8fa81f4e-2cfe-5445-be54-c6951721651f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93378, 2644, 391, 7, 20, "Subsubitem",ExpressionUUID->"fbb20c4e-fe6e-b049-aabc-c68507587a5c"],
Cell[CellGroupData[{
Cell[93794, 2655, 5702, 166, 236, "Input",ExpressionUUID->"b4c8ab98-563a-d041-8313-3e5b4080480f"],
Cell[99499, 2823, 982, 24, 45, "Output",ExpressionUUID->"ec2cf314-36f2-a848-a812-8f8c7d90a587"],
Cell[100484, 2849, 543, 12, 44, "Output",ExpressionUUID->"8e68b88e-4454-a54e-ab83-d505e4241b23"],
Cell[101030, 2863, 399, 7, 40, "Output",ExpressionUUID->"c6647c5f-9f2f-2746-be14-4f49eb5699c2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[101478, 2876, 446, 9, 20, "Subsubitem",ExpressionUUID->"f4fa26c4-3d9e-604e-a2ad-6934014d3152"],
Cell[CellGroupData[{
Cell[101949, 2889, 5303, 153, 221, "Input",ExpressionUUID->"a33ae952-3835-b947-a9fd-202a9eec3c2d"],
Cell[107255, 3044, 635, 13, 44, "Output",ExpressionUUID->"a0c23b2d-b641-4249-91e8-ac4f465cbfc4"],
Cell[107893, 3059, 501, 8, 40, "Output",ExpressionUUID->"d2b69fe2-2a3c-8947-8fd7-1db06cf2c4f6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108455, 3074, 311, 7, 22, "Subitem",ExpressionUUID->"a8ad6383-460c-1949-96ab-6a88ab777456"],
Cell[CellGroupData[{
Cell[108791, 3085, 266, 5, 20, "Subsubitem",ExpressionUUID->"8a566e29-c1b3-c14e-88a5-c540ee416bca"],
Cell[CellGroupData[{
Cell[109082, 3094, 9644, 271, 236, "Input",ExpressionUUID->"9bf57419-8f49-d540-b265-ff7eea825cfe"],
Cell[118729, 3367, 837, 24, 43, "Output",ExpressionUUID->"29a7c73d-4a32-614c-ba1f-f42d79638bf7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119603, 3396, 364, 10, 22, "Input",ExpressionUUID->"be3d8018-4699-8048-aed3-825cdd74f85c"],
Cell[119970, 3408, 202, 4, 40, "Output",ExpressionUUID->"19189c00-4d2d-9a43-9254-86ed8894c5c8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[120221, 3418, 682, 11, 35, "Subsubitem",ExpressionUUID->"f83500ec-da75-344f-9572-76d9879c7185"],
Cell[CellGroupData[{
Cell[120928, 3433, 11340, 334, 328, "Input",ExpressionUUID->"812706c6-d56b-4f47-94f5-78a8639f5005"],
Cell[132271, 3769, 1244, 32, 47, "Output",ExpressionUUID->"3e0be7dd-4679-cf49-94b6-34beed9bf76b"],
Cell[133518, 3803, 496, 8, 40, "Output",ExpressionUUID->"ec6bbcf7-b3a7-6a40-941e-ee17a9d4ef60"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[134075, 3818, 335, 7, 22, "Subitem",ExpressionUUID->"b455b96b-4427-fa42-9e37-4e9236061472"],
Cell[CellGroupData[{
Cell[134435, 3829, 266, 5, 20, "Subsubitem",ExpressionUUID->"6b9e2fd7-9424-8141-890a-ae33722dbbce"],
Cell[CellGroupData[{
Cell[134726, 3838, 10427, 289, 236, "Input",ExpressionUUID->"1c083c4d-58a9-154f-a306-5520853d16bf"],
Cell[145156, 4129, 1342, 39, 43, "Output",ExpressionUUID->"7f5442fa-5ac9-964b-9e63-d47456addfc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146535, 4173, 446, 11, 22, "Input",ExpressionUUID->"13e31e42-20fa-bc45-80bd-5e4e05a65170"],
Cell[146984, 4186, 269, 5, 40, "Output",ExpressionUUID->"be9ad53e-5ecc-db46-a5fd-b73ee4c4dc91"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[147302, 4197, 735, 12, 35, "Subsubitem",ExpressionUUID->"dab72dd3-f296-a547-ae5c-23d82e9dc0c3"],
Cell[CellGroupData[{
Cell[148062, 4213, 11678, 344, 328, "Input",ExpressionUUID->"79ceda6c-ad2d-5349-b1ec-e251df942bf4"],
Cell[159743, 4559, 1244, 32, 47, "Output",ExpressionUUID->"c354b90c-a3e9-254e-93c7-8f3dda96d18f"],
Cell[160990, 4593, 496, 8, 40, "Output",ExpressionUUID->"fe449c6e-172e-cf46-9edd-6ca832af73bf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

